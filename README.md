# ClinicPro Manager

## Overview
ClinicPro Manager is a premium web application designed for highâ€‘ticket dental clinics. It centralises patient management, budgeting, sales, clinical dashboards, CRM pipelines, and financial operations in a modern, mobileâ€‘first UI.

## Tech Stack
- **Framework**: Vite + React 18
- **Language**: TypeScript
- **Styling**: Tailwind CSS (with Tailwindâ€‘merge & tailwindcssâ€‘animate)
- **State Management**: Zustand + React Context
- **Data Layer**: Supabase (client library `@supabase/supabase-js`)
- **UI Components**: Radix UI, Lucideâ€‘react, Framer Motion, Recharts, Vaul
- **Utilities**: reactâ€‘hotâ€‘toast, dateâ€‘fns, xlsx, jspdf, dotenv
- **Build**: Vite, ESLint, TypeScript

## Architecture
```
src/
â”œâ”€ components/          # Reâ€‘usable UI components (forms, cards, charts, etc.)
â”œâ”€ contexts/            # React context providers (DataContext, AuthContext)
â”œâ”€ pages/               # Nextâ€‘style page routes (clinical, sales, reports, settings)
â”‚   â””â”€ clinical/        # BudgetStudio, SalesTerminal, ClinicalDashboard, etc.
â”œâ”€ services/            # API wrappers for Supabase and custom backâ€‘end logic
â”œâ”€ hooks/               # Custom React hooks (useBudget, useAuth, etc.)
â”œâ”€ types/               # TypeScript type definitions and enums
â”œâ”€ utils/               # Helper functions (formatters, validators)
â””â”€ src/obsoletos/       # Legacy files kept for reference
```
- **Contexts** provide global state (patients, budgets, appointments) and expose stable callbacks via `useCallback` to avoid reâ€‘renders.
- **Pages** are the main entry points; each page composes components and hooks to implement a feature.
- **Services** encapsulate Supabase queries, keeping data access separate from UI logic.

## Core Modules
- **Budget Studio** â€“ Multiâ€‘step budget creation, negotiation, and approval workflow.
- **Sales Terminal** â€“ Realâ€‘time sales queue, financial calculations, and register handling.
- **Clinical Dashboard** â€“ Kanbanâ€‘style production view for appointments and treatments.
- **CRM / Pipeline** â€“ Lead management, pipeline visualisation, and activity tracking.
- **Finance** â€“ Cash registers, expense tracking, installments, and reporting.
- **Settings** â€“ Clinic configuration, user/role management, and integration settings.

## Installation & Running
```bash
# Clone the repo
git clone https://github.com/Tchelovb/clinicpro_manager.git
cd clinicpro_manager

# Install dependencies
npm install

# Set up environment variables (copy .env.example â†’ .env.local)
cp .env.example .env.local
# Edit .env.local with your Supabase credentials

# Run the development server
npm run dev
```
The app will be available at `http://localhost:5173`.

## Contributing
- Follow the existing folder conventions.
- Run `npm run lint` before committing.
- Ensure TypeScript builds with `npm run build:check`.

---
*Generated by Antigravity AI after a full system audit.*

## âš ï¸ PROTOCOLO DE PRESERVAÃ‡ÃƒO (2026)

### Componentes Protegidos (IMUTÃVEIS)
Os seguintes componentes constituem a base da **UX "Agenda Elite" (PadrÃ£o Apple)**. 
Eles **nÃ£o devem ser alterados, removidos ou reescritos** sem autorizaÃ§Ã£o expressa do Dr. Marcelo.

*   ğŸ”’ `components/ui/MobileTabBar.tsx` (NavegaÃ§Ã£o Inferior)
*   ğŸ”’ `components/ui/MobileDrawer.tsx` (Sheet Base com Haptics)
*   ğŸ”’ `components/Sidebar.tsx` (Smart Sidebar Desktop)
*   ğŸ”’ `src/lib/utils.ts` (Formatadores Oficiais Blindados)
*   ğŸ”’ `components/shared/AppShell.tsx` (Layout Mestre com Padding Seguro)
*   ğŸ”’ `components/shared/SheetProvider.tsx` (Gerenciador Global de Gavetas)
*   ğŸ”’ `src/services/documents/TemplateService.ts` (Motor de LÃ³gica BancÃ¡ria)
*   ğŸ”’ `components/documents/EliteDocumentEngine.tsx` (MÃ³dulo de Contratos)
*   ğŸ”’ `components/documents/FinancialInvestmentTable.tsx` (Extrato BancÃ¡rio de Invest.)
*   ğŸ”’ `components/shared/EliteEditor.tsx` (Editor TipTap Apple)

**Regra de Desenvolvimento:**
Ao criar novas funcionalidades, **importe** estes componentes. Use o "cofre" em `src/components/shared/` para acesso facilitado a drawers comuns. **Nunca tente recriar** a lÃ³gica de animaÃ§Ã£o ou haptics destes arquivos.

### Performance Lock ğŸ”’
*   **Optimistic UI:** ObrigatÃ³rio para todas as novas aÃ§Ãµes de usuÃ¡rio (Salvar, Editar, Deletar). A interface deve responder em < 50ms.
*   **Zero Latency:** Buscas frequentes devem usar cache client-side (como implementado em `SearchContent.tsx`).
*   **Utils:** Proibido formatar data/dinheiro inline. Use sempre as funÃ§Ãµes de `src/lib/utils.ts`.

---

### ğŸ›¡ï¸ Funcionalidades Elite (Ativas)
*   âœ… **Bundle CirÃºrgico de AprovaÃ§Ã£o**: Contrato + TCLE + InstruÃ§Ãµes (PrÃ©/PÃ³s) + Receita + PromissÃ³ria em um clique.
*   âœ… **BÃ­blia JurÃ­dica Blindada**: Os templates de Contrato (CONTRACT) e TCLE formam a base legal da clÃ­nica.
    *   âš ï¸ **RestriÃ§Ã£o de EdiÃ§Ã£o**: ClÃ¡usulas de rescisÃ£o, multa (2%) e juros (1%) sÃ£o injetadas dinamicamente e *nÃ£o devem ser alteradas manualmente* sem autorizaÃ§Ã£o jurÃ­dica.
    *   ğŸ” **Rastreabilidade**: Todo documento gerado possui IP de Origem e Hash Ãºnico no rodapÃ© para validade em disputas.
